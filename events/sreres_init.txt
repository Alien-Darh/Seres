namespace = seres_init

country_event = {
    id = seres_init.01
	title = seres_init.01.name
	desc = seres_init.01.desc
	picture = GFX_evt_seres_init
	show_sound = event_mystic_reveal
	location = root

	is_triggered_only = yes

	trigger = {	
		owner = { is_ai = no }
	}

	option = {
		name = seres_init.01.a
		owner = {
			if = {
				limit = {
				NOT = { has_technology = tech_mod_warp_drive_1 }
				}
				give_technology = { tech = tech_mod_warp_drive_1 }
			}
			else = {			
			}
		}	
 
		hidden_effect = {
			solar_system = {
				random_system_planet = {
					limit = { is_moon = yes }
					save_event_target_as = deposit_advance
				}	
			}
		}
		
		event_target:deposit_advance = {
			planet_event = {
				id = seres_init.011
				days = 900
			}
		}
		hidden_effect = {
			country_event = { id = seres_init.022 days = 1800 }
		}						
	}	
	
	option = {
		name = seres_init.01.b
	}	
}

planet_event = {
	id = seres_init.011
	hide_window = yes
	location = root	

	is_triggered_only = yes
	
	immediate = { 
		clear_deposits = yes
		add_deposit = d_dilithium_crystals_2
		if = {
			limit = { has_mining_station = yes }
			random_mining_station = { dismantle = yes }
		}
		if = {
			limit = { has_research_station = yes }
			random_research_station = { dismantle = yes }
		}		
	}
}

country_event = {
    id = seres_init.022
	hide_window = yes	
	location = root	
	
	is_triggered_only = yes	
	
	option = {
		give_technology = {
			tech = tech_mine_dilithium_crystals
		}
	}	
}

country_event = {
    id = seres_init.02
	title = seres_init.02.name
	desc = seres_init.02.desc
	picture = GFX_evt_seres_init_crisis
	show_sound = event_mystic_reveal
	location = root

	fire_only_once = yes	
	#is_triggered_only = yes

	trigger = {	
		owner = { is_ai = no }
        OR = {
            has_global_flag = prethoryn_arrival
            has_global_flag = prethoryn_main_invasion
            has_global_flag = ai_invasion_ongoing
            has_global_flag = extradimensional_invasion_happened
            has_global_flag = extradimensional_second_portal
            has_global_flag = extradimensional_third_portal
        }
    }
	
	mean_time_to_happen = {
		months = 12
	}
	
	option = {
		name = seres_init.02.a
		add_research_option = tech_dark_matter_deflector
			add_tech_progress = {
				tech = tech_dark_matter_deflector
				progress = 0.25
			}
		add_research_option = tech_dark_matter_propulsion
			add_tech_progress = {
				tech = tech_dark_matter_propulsion
				progress = 0.25
			}
		add_research_option = tech_dark_matter_power_core
			add_tech_progress = {
				tech = tech_dark_matter_power_core
				progress = 0.25	
		}		
	}
	
	option = {
		name = seres_init.02.b	
		add_modifier = {
			modifier = mod_darhmod_precursor_seres_secrets_final
			days = -1
		}
	}
	option = {
		name = seres_init.02.c		
		add_modifier = {
			modifier = fallen_empire_gift_databanks
			days = -1
		}
	}			
}